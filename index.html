<!DOCTYPE html>
<html>
<head>
<title>Zombie Shooter Camera Mode</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
body { margin:0; overflow:hidden; background:black; font-family:Arial; }
#cam { position:fixed; top:0; left:0; width:100vw; height:100vh; object-fit:cover; z-index:1; }
#gameCanvas { position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:2; }
#hud { position:fixed; top:10px; left:10px; color:white; font-size:18px; z-index:3; }
</style>
</head>

<body>

<video id="cam" autoplay playsinline></video>
<canvas id="gameCanvas"></canvas>
<div id="hud">Score: <span id="score">0</span></div>

<script>
// ==== Camera =====
const video = document.getElementById('cam');
navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
.then(stream => video.srcObject = stream)
.catch(err => {
  alert("Camera blocked. Allow permission & refresh.");
});

// ==== Game Layer ====
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

let zombies = [];
let score = 0;

function spawnZombie() {
  zombies.push({
    x: Math.random()*canvas.width,
    y: canvas.height,
    size: 50 + Math.random()*30,
    speed: 1 + Math.random()*2
  });
}

setInterval(spawnZombie, 1000);

canvas.addEventListener("click", (e)=>{
  const mx = e.clientX, my = e.clientY;
  zombies = zombies.filter(z => {
    const hit = mx>z.x && mx<z.x+z.size && my>z.y && my<z.y+z.size;
    if(hit) score++;
    return !hit;
  });
  document.getElementById("score").textContent = score;
});

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  zombies.forEach(z => {
    z.y -= z.speed;
    ctx.fillStyle = "green";
    ctx.fillRect(z.x, z.y, z.size, z.size);
  });
  requestAnimationFrame(draw);
}

draw();
</script>
</body>
</html>
